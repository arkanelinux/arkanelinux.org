<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta property="og:title" content="Arkane Linux - Introduction">
		<meta property="og:description" content="An opinionated, immutable multi-root Arch-based Linux distibution.">
		<meta property="og:image" content="https://arkanelinux.org/img/branding/arkane-logo.webp">
		<title>Arkane Linux - Introduction</title>
		<link rel="stylesheet" href="/style/main.css">
		<link rel="stylesheet" href="/style/fonts.css">
		<link rel="stylesheet" href="/style/responsive.css">
	</head>
	<body>
    <header>
    <div class="header_container">
      <div class="project_name">
      <p>Arkane Linux</p>
      </div>
      <div class="nav">
	      <a href="/">Home</a>
	      <a href="/downloads">Download</a>
	      <a href="/about">About</a>
	      <a href="https://github.com/arkanelinux/" target="_blank">GitHub</a>
      </div>
    </div>
    </header>
		<div class="banner">
			<div class="container_paragraph">
				<div class="text_box_wide">
					<h1 class="font_thin padded_h">Getting started with Arkane Linux</h1>
					<p>Lets start off with setting expectations; Arkane Linux is accessible to all, yet it assumes those using it have a fairly decent understanding of GNU/Linux. Arkane avoids pointless abstraction, this means the system does not do any hand-holding, it assumes you are familiar with the components which comprise it and have the ability to read the manual of said components.</p>
					<p>This document will provide you with some example usage or Arkdep, and give you a technical overview of the detail and specifics of Arkane Linux's configuration.</p>
					<p>Here is detailed the default configurion of an installed system, the configuration of the ISO installation images differs in various ways from a full proper install.</p>
					<h2 class="font_thin padded_hb">Arkdep usage</h2>
					<p>The system is updated like so;</p>
					<div class="codeblock">sudo arkdep deploy</div>
					<p>When the <code>deploy</code> parameter is passed without providing any further arguments Arkdep will read <code>/arkdep/config</code> and combine <code>$repo_url/$repo_default_image</code> to infer from where it is expected to download its images and which image variant it should download. It will download the database file at <code>$repo_url/$repo_default_image/database</code> and grab the very first entry in the list, the top most entry in the database file is assumed to be the latest image available.</p>
					<br>
					<p>A specific image variant can be pulled like so;</p>
					<div class="codeblock">sudo arkdep deploy test-arkanelinux-kde</div>
					<p>Providing this extra argument will overwrite <code>$repo_default_image</code> allowing you to pull a different image variant from the same repository.</p>
					<br>
					<p>Specific image versions can also be requested;</p>
					<div class="codeblock">sudo arkdep deploy test-arkanelinux-kde aaabbbccc</div>
					<p>This argument will make it search the database file and download the first hit it finds.</p>
					<p>If you are intend on pulling a specific version of the default image variant as defined in <code>$repo_default_image</code> the variant may be substituted with a <code>-</code>.</p>
					<div class="codeblock">sudo arkdep deploy - aaabbbccc</div>
					<br>
					<p>Any image present in <code>/arkdep/cache</code>, for example an image called <code>aaabbbccc.tar.zst</code>, can also be installed directly skipping the database download;</p>
					<div class="codeblock">sudo arkdep deploy cache aaabbbccc</div>
					<h2 class="font_thin padded_hb">Spinning custom images with arkdep-build</h2>
					<p>Do you like the technology but do not like the provided images? No problem! You can easily spin and deploy custom images should you desire to do so.</p>
					<p>First make a copy of one of the existing arkane-build configurations in to a directory named <code>arkane-build.d</code>;</p>
					<div class="codeblock">mkdir arkane-build.d
					cp -r /etc/arkdep/test-arkanelinux-kde arkane-build.d/</div>
					<p>Next make your edits to the configuration files in <code>arkdep-build.d/test-arkanelinux-kde</code>, you may also rename the <code>test-arkanelinux-kde</code> configuration's directory, the name of the directory is used to build a specific image by name.</p>
					<div class="codeblock">mv arkdep-build.d/test-arkanelinux-kde arkdep-build.d/customlinux</div>
					<p><code>base.list</code> contains a list of packages installed during the bootstrapping process using pacstrap. <code>package.list</code> contains a list of packages which will be installed after the bootstrapping process using a chrooted pacman.</p>
					<p><code>type</code> is expected to be present but right now only accepts <code>archlinux</code>, in the future support for more distro families will be added.</p>
					<p>The <code>overlay</code> directory is copied to root after the packages are installed, use the overlay to add custom config files or to enable systemd services.</p>
					<br>
					<p>Once all the desired changes have been made you can spin a new image by navigating to <code>arkdep-build.d</code>'s parant directory and running arkdep-build.</p>
					<div class="codeblock">sudo arkdep-build customlinux</div>
					<p>Once the image has finished building it will be placed inside of a directory called <code>target</code> located in the <code>arkdep-build.d</code> parent directory. To then install it without using an external repository copy the achive in to the <code>/arkdep/cache</code> directory and define cache as the image variant when doing a deployment.</p>
					<div class="codeblock">sudo cp target/aaabbbccc.tar.zst /arkdep/cache/
					sudo arkdep deploy cache aaabbbccc</div>
					<h2 class="font_thin padded_hb">Base configuration of GNOME-based variants</h2>
					<p>The GNOME variants all provide a very comparable configuration, a stock gnome-shell with the following notable tweaks and configurations;</p>
					<ul>
						<li>Dark mode by default</li>
						<li>A custom wallpaper</li>
						<li>Preloaded with stable but not (yet) default GNOME apps from the GNOME Circle and GNOME Project</li>
						<li><code>mutter-dynamic-buffering</code> patches included</li>
						<li>Rebuild of <code>gnome-software</code> with packagekit support</li>
						<li><code>/home</code> Btrfs subvolume</li>
						<li>systemd-boot bootloader</li>
						<li>Swapfile configured in <code>/var</code></li>
					</ul>
					<h2 class="font_thin padded_hb">Arkdep-based system specific</h2>
					<p>Arkdep images mostly grab the above mentioned configuration with the exclusion of the packagekit plugin, since the system is immutable and managed by arkdep there is no reason to include it.</p>
					<p>The following changes are applied to the filesystem;</p>
					<ul>
						<li><code>/opt</code> is symlinked to <code>/var/opt</code></li>
						<li><code>/srv</code> is symlinked to <code>/var/srv</code></li>
						<li><code>/root</code> is symlinked to <code>/var/roothome</code></li>
						<li><code>/usr/local</code> is symlinked to <code>/var/usrlocal</code></li>
						<li><code>/usr/lib/locale</code> is symlinked to <code>/var/usrliblocale</code></li>
					</ul>
					<p>And the following changes in software and configuration;</p>
					<ul>
						<li><code>libnss-extrausers</code> PAM module included by default</li>
						<li><code>shadow</code>, <code>passwd</code> and <code>group</code> files with system accounts are stored in <code>/usr/lib</code>, these are loaded by the extrausers PAM module</li>
						<li><code>shadow</code>, <code>passwd</code> and <code>group</code> files in <code>/etc</code> exclusively store root and normal user accounts</li>
						<li><code>podman</code> is included by default</li>
					</ul>
					<p>Some notable quirks you should be aware of;</p>
					<ul>
						<li><code>/etc</code> is a separate subvolume living inside of the root of the deployment, it is writable by default</li>
						<li>Any changes outside of <code>/var</code> and <code>/home</code> do not carry over between deployments, manually add your changes to <code>/arkdep/overlay</code></li>
						<li><code>/var</code> and <code>/home</code> are shared between all deployments and are stored in <code>/arkdep/shared</code></li>
						<li>Adding any overlay files outside of <code>/arkdep/overlay/etc</code> will make arkdep temporarily unlock the root subvolume for editing</li>
						<li>The default bootloader entry is changed using UEFI variables on deployment completion, manually use <code>bootctl set-default</code> to change the default deployment to roll back to an older deployment and make it default, or select said older deployment in the systemd-boot bootloader interface</li>
					</ul>
				</div>
			</div>
		</div>
	</body>
</html>
